import{r as n,o as G,l as c,w as Q,a as s,c as a,u as l,b as r,v as p,d as e,e as N,f,t as v,g as _,F as O,h as X,i as Y}from"./index-c34b9e28.js";import{f as Z,c as ee,p as oe,d as te}from"./poi-eaa93649.js";const ne={key:0},le={key:0},ie=e("span",null,"Insert a new poi",-1),se=e("br",null,null,-1),ae=e("option",{disabled:"",value:""},"Seleziona una Tipologia",-1),ue=e("option",null,"Monumentario",-1),re=e("option",null,"Artistico",-1),de=e("option",null,"Culinario",-1),ce=[ae,ue,re,de],ve=e("option",{disabled:"",value:""},"Aperto o Chiuso",-1),pe=e("option",null,"Aperto",-1),me=e("option",null,"Chiuso",-1),_e=[ve,pe,me],fe=e("br",null,null,-1),ge={style:{color:"red"}},he=e("h1",null,"Poi:",-1),ke=["onClick"],ye={key:0},ze={key:1},be=["onClick"],Pe={style:{color:"red"}},Ve=["onClick"],Ue=e("br",null,null,-1),Se={style:{color:"red"}},$e={key:1},Ce=e("br",null,null,-1),we={style:{color:"red"}},Te=e("br",null,null,-1),Ie=["src"],Ee=e("br",null,null,-1),Me=["href"],De={__name:"PoiTable",setup(B){const V={}.VITE_API_HOST||"http://localhost:8080",E=V+"/reviews",g=n(""),U=n(""),h=n(""),k=n(""),S=n(""),y=n("");n("");const z=n(""),C=n(""),w=n(""),T=n(""),b=n(""),u=n(""),M=n(""),A=n(""),L=n(""),$=n("");let D=!1,P=!1,I=!1,d=n(""),x=n("");G(()=>{c.token=$cookies.isKey("email"),c.nome=$cookies.get("nome"),c.email=$cookies.get("email"),c.id=$cookies.get("id"),I=$cookies.isKey("poiSelezionato"),d=$cookies.get("poiSelezionato"),$cookies.get("ruolo")=="gestore"?P=!0:$cookies.get("ruolo")=="utente"&&(D=!0),console.log(d),Z()}),Q(c,(i,o)=>{u.value="",$.value=""});function R(){if(g.value==""||U.value==""||h.value==""||k.value==""||S.value==""||y.value==""||z.value==""){u.value="Compila tutti i campi";return}if(typeof g.value!="string"){u.value="Nome non è in formato stringa";return}if(typeof h.value!="string"){u.value="Descrizione non è in formato stringa";return}if(typeof k.value!="string"){u.value="Posizione non è in formato stringa";return}if(typeof y.value!="string"){u.value="Orari Apertura non è in formato stringa";return}if(typeof z.value!="string"){u.value="Immagine non è in formato stringa";return}u.value="",ee(g.value,U.value,h.value,k.value,S.value,y.value,z.value).catch(i=>console.error(i))}function j(i){te(i).catch(o=>console.error(o)),L.value="Delete Poi effettuata"}function F(i){if(console.log(i),console.log(c.id),!c.token){u.value="Please login to review a Poi!";return}if(b.value<1||b.value>5){M.value="Valore tra 1 e 5!!";return}u.value="",fetch(E,{method:"POST",headers:{"Content-Type":"application/json","x-access-token":c.token},body:JSON.stringify({titolo:C.value,descrizione:w.value,valutazione:b.value,utente:c.id,poi:i.self})}).then(o=>{location.reload()}).catch(o=>console.error(o))}async function H(i){x.value=await(await fetch(V+"/"+i.self)).json(),$cookies.set("poiSelezionato",x.value,86400),location.reload()}function J(){$cookies.remove("poiSelezionato"),$cookies.remove("poiSelezionato2"),location.reload()}function K(){return d.immagine}function W(){return d.posizione}function q(i){fetch(V+"/pois/"+i,{method:"PUT",headers:{"Content-Type":"application/json","x-access-token":c.token},body:JSON.stringify({nDesc:T.value})}).then(o=>{if(o.status==204){$.value="Inserisci una stringa";return}else{$.value="",location.reload();return}}).catch(o=>console.error(o))}return(i,o)=>(s(),a(O,null,[l(I)?_("",!0):(s(),a("div",ne,[l(P)?(s(),a("form",le,[ie,se,r(e("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>g.value=t),placeholder:"nome"},null,512),[[p,g.value,void 0,{string:!0}]]),r(e("select",{"onUpdate:modelValue":o[1]||(o[1]=t=>U.value=t)},ce,512),[[N,U.value]]),r(e("input",{"onUpdate:modelValue":o[2]||(o[2]=t=>h.value=t),placeholder:"descrizione"},null,512),[[p,h.value]]),r(e("input",{"onUpdate:modelValue":o[3]||(o[3]=t=>k.value=t),placeholder:"posizione"},null,512),[[p,k.value]]),r(e("select",{"onUpdate:modelValue":o[4]||(o[4]=t=>S.value=t)},_e,512),[[N,S.value]]),r(e("input",{"onUpdate:modelValue":o[5]||(o[5]=t=>y.value=t),placeholder:"orari_apertura"},null,512),[[p,y.value]]),r(e("input",{"onUpdate:modelValue":o[6]||(o[6]=t=>z.value=t),placeholder:"immagine"},null,512),[[p,z.value]]),f("  "),e("button",{type:"button",onClick:R},"Inserisci nuovo Poi "),fe,e("span",ge,v(u.value),1)])):_("",!0),he,e("ul",null,[(s(!0),a(O,null,X(l(oe).value,t=>(s(),a("li",{key:t.self},[e("button",{onClick:m=>H(t)},v(t.nome,t.descrizione),9,ke),i.ruolo?(s(),a("a",ye," ")):_("",!0),l(D)?(s(),a("div",ze,[r(e("input",{"onUpdate:modelValue":o[7]||(o[7]=m=>C.value=m),placeholder:"titolo"},null,512),[[p,C.value]]),r(e("input",{"onUpdate:modelValue":o[8]||(o[8]=m=>w.value=m),placeholder:"descrizione"},null,512),[[p,w.value]]),r(e("input",{"onUpdate:modelValue":o[9]||(o[9]=m=>b.value=m),type:"number",placeholder:"valutazione",min:"1",max:"5"},null,512),[[p,b.value]]),f("   "),e("button",{onClick:m=>F(t)},"REVIEW",8,be)])):_("",!0),e("span",Pe,v(M.value),1),f("   "),l(P)?(s(),a("button",{key:2,onClick:m=>j(t)},"DELETE",8,Ve)):_("",!0),Ue,e("span",Se,v(A.value),1)]))),128))])])),l(I)?(s(),a("div",$e,[e("h1",null,v(l(d).nome)+" : "+v(l(d).tipologia),1),e("h2",null,v(l(d).descrizione),1),f(),l(P)?r((s(),a("input",{key:0,"onUpdate:modelValue":o[10]||(o[10]=t=>T.value=t),placeholder:"cambia descrizione"},null,512)),[[p,T.value]]):_("",!0),f(),l(P)?(s(),a("button",{key:1,onClick:o[11]||(o[11]=t=>q(l(d).id))},"Update")):_("",!0),Ce,e("span",we,v($.value),1),Te,e("img",{src:K(),height:"700",width:"1200"},null,8,Ie),f(),Ee,e("a",{href:W(),target:"_blank"},"Premi qui per la posizione",8,Me),e("h1",null,v(l(d).stato),1),e("h1",null," Orario di apertura : "+v(l(d).orari_apertura),1),e("button",{onClick:o[12]||(o[12]=t=>J())}," Torna Indietro")])):_("",!0)],64))}},Oe={__name:"PoiView",setup(B){return(V,E)=>(s(),a("div",null,[Y(De)]))}};export{Oe as default};
